# yaml-language-server:$schema=./node_modules/lefthook/schema.json
# https://github.com/evilmartians/lefthook/blob/master/docs/configuration.md

pre-commit:
  parallel: true
  jobs:
    - name: QA
      group:
        piped: true
        jobs:
          - name: biome
            glob: "*.{ts,tsx,js,jsx,json,jsonc,css}"
            run: na biome check --fix {staged_files} --reporter summary
            stage_fixed: true
          - name: typescript
            glob: "*.{ts,tsx}"
            run: na tsc --noEmit
          - name: vitest
            glob: "*.{test.ts,test.tsx,spec.ts,spec.tsx}"
            run: nr test

    - name: Audit
      group:
        parallel: true
        jobs:
          - name: gitleaks
            run: gitleaks protect --staged --no-banner
          - name: audit
            run: echo audit
          - name: license
            run: echo license
          - name: doctor
            run: na expo-doctor

    - name: Misc
      group:
        parallel: true
        jobs:
          - name: knip
            run: na knip --no-exit-code --no-config-hints
